var sheets=[],keywords="",filters=[],noMatchMsg=null;function searchSheets(e){keywords=e;var t=e.toLowerCase().split(" "),s=!1;sheets.forEach((function(e){s=t.every((function(t){return e.dataset.kw.includes(t)})),e.style.display=s?"":"none"})),handleNoMatch()}function updateFilters(){filters=[],document.querySelectorAll('[name^="filter-"]:checked').forEach((function(e){"all"!==e.value&&filters.push(e.value)})),filterSheets()}function filterSheets(){var e=!1;sheets.forEach((function(t){e=filters.every((function(e){return t.dataset.f.includes(e)})),t.classList.toggle("filtered",!e)})),handleNoMatch()}function sortSheets(){for(var e,t=document.querySelector('[name="sort"]:checked').value,s=!0,n=!1;s;){for(s=!1,e=0;e<sheets.length-1;e++){switch(n=!1,t){case"title":n=sheets[e].dataset.kw>sheets[e+1].dataset.kw;break;case"publish-date":n=sheets[e].dataset.pd<sheets[e+1].dataset.pd}if(n){sheets[e].parentNode.insertBefore(sheets[e+1],sheets[e]),s=!0;break}}sheets=document.querySelectorAll("#sheet-list li")}}function handleNoMatch(){var e=Array.from(sheets).some((function(e){return null!==e.offsetParent}));noMatchMsg.style.display=e?"none":""}function displayNew(){var e=new Date(Date.now()-6048e5).toISOString().slice(0,10).replace(/-/g,""),t=document.createElement("span");t.classList.add("new"),t.innerHTML="NEW",sheets.forEach((function(s){s.dataset.pd>e&&s.appendChild(t.cloneNode(!0))}))}document.addEventListener("DOMContentLoaded",(function(){sheets=document.querySelectorAll("#sheet-list li"),noMatchMsg=document.getElementById("nomatch"),displayNew(),searchSheets(document.getElementById("keyword").value),updateFilters(),sortSheets(),document.querySelectorAll('[name^="filter-"]').forEach((function(e){e.addEventListener("change",(function(e){updateFilters()}))})),document.querySelectorAll('[name="sort').forEach((function(e){e.addEventListener("change",(function(e){sortSheets()}))}))}));